<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width" />
        
        <!-- firebase initialisation -->
        
        <script src="https://www.gstatic.com/firebasejs/4.8.0/firebase.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script>
          // Initialize Firebase
          var config = {
            apiKey: "AIzaSyButp2-SFrYWWGZEZORCtE5K12WATgyPvc",
            authDomain: "okayestcoder.firebaseapp.com",
            databaseURL: "https://okayestcoder.firebaseio.com",
            projectId: "okayestcoder",
            storageBucket: "okayestcoder.appspot.com",
            messagingSenderId: "935764653668"
          };
          firebase.initializeApp(config);
            
            var database = firebase.database();

            var dataDump = database.ref('posts').orderByChild('index');
     
            var string_of_posts = "";
            dataDump.on('value', function(snapshot) {
                snapshot.forEach(function(childSnapshot) {
                
                var childData = childSnapshot.val();
                // console.log(childData['tags']);

                    // Generate the HTML for #main
            
                var postNum = (childData['index']);
                if(parseInt(childData['index']) % 2 == 0) { 
                string_of_posts += '<div class="post" onclick="displayPost(' + postNum + ')">';
                } else {
                   string_of_posts += '<div class="post2" onclick="displayPost(' + postNum + ')">';
                }
                 string_of_posts += '<div class="postContent"><img src="testimg.jpg" align="right" alt="test!" />' +
                        '<h2>' + childData['title'] + '</h2>' +
                        '<h3>' + childData['date'] + '</h3>' ;
                string_of_posts += childData['text'].slice(0,250) + '....<strong> Continue</strong><br />' +
                    '<h5><strong>Tags </strong>';
                for(var i = 0; i < childData['tags'].length; i++) {
                    string_of_posts += '<mark>&nbsp;' + childData['tags'][i] + '&nbsp;</mark>&nbsp;&nbsp;';
                }
                string_of_posts += '</h5></div></div>';
            });
            // Map HTML to #main div content
            var list_of_posts = string_of_posts;
            $('#main').html(list_of_posts);   
        });
            
            
        </script>
        <script src="htmlImporter.js"></script>
        <title>The Okay-est Coder: Home</title>
        <link rel="stylesheet" type="text/css" href="mainstyle.css">
        
    </head>
    
    <body>
        
     <script>HTMLImporter.import("menu.html");</script>

        <div id="main">
            <!-- Sample Data to pad -->
            <!--
            <a href="post.html">
                <div class="post2">

                    <div class="postContent">
                        <img src="testimg.jpg" align="right" alt="test!" />

                       <h2>This is a post!</h2>
                        This is a post contents!!I'm gonna waffle about some stuff 
                        as if it's an article and woop dsdkh This is a post contents!!I'm gonna waffle about some stuff <br /><br />More Staff<br /><br />Even<br /><br />More stuff

                    </div>      
                </div>
            </a>
            -->   
        </div>
            <script>
            
            function displayPost(postNum) {
                
         var database = firebase.database();
                console.log(postNum);
                post_string = "";
            var dataDump = database.ref('posts').orderByChild('index');
     
            dataDump.on('value', function(snapshot) {
                snapshot.forEach(function(childSnapshot) {

                var childData = childSnapshot.val();
                        if(childData['index'] == postNum ) {
                            if(postNum % 2 == 0)
                            post_string += '<div class="post">';
                            else{
                                post_string += '<div class="post2">';
                            }
                            post_string += '<div class="postContentFull">' +
                            '<h2><a href="index.html">< Return to home</h2>' +
                            '<h1>' + childData['title'] + '</h1>' +
                        '<h3>' + childData['date'] + '</h3>' +
                                 '<h5><strong>Tags </strong>';
                for(var i = 0; i < childData['tags'].length; i++) {
                    post_string += '<mark>&nbsp;' + childData['tags'][i] + '&nbsp;</mark>&nbsp;&nbsp;';
               
                   
                }
                             post_string += '</h5>' + childData['text'] + '<br /><br /></div></div>';
                            
                        }
                  
                    });
                });
                
                $('#main').html(post_string);
   
            }
            </script>
              
    </body>
</html>